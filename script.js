document.addEventListener("DOMContentLoaded",function(){const e={},t=document.getElementById("services-data");t&&t.querySelectorAll("[data-client-profile]").forEach(t=>{const o=t.dataset.clientProfile;e[o]={accordion:Array.from(t.querySelectorAll(".service-item")).map(e=>({title:e.dataset.title,description:e.dataset.description,details:Array.from(e.querySelectorAll(".service-detail")).map(e=>({title:e.dataset.title,text:e.dataset.text}))}))}});const o=document.getElementById("service-selector"),s=document.getElementById("services-accordion"),i=document.documentElement,n={artist:"var(--color-artist)",producer:"var(--color-producer)",media:"var(--color-media)",enterprise:"var(--color-enterprise)"};function l(e){const t="es"===document.documentElement.lang?`Expandir detalles de ${e.title}`:`Expand details for ${e.title}`,o=e.details.map(e=>`\n            <div class="service-detail-item">\n                <h4>${e.title}</h4>\n                <p>${e.text}</p>\n            </div>\n        `).join("");return`\n            <div class="accordion-item">\n                <div class="accordion-header">\n                    <div class="accordion-text">\n                        <h3 class="accordion-title">${e.title}</h3>\n                        <p class="accordion-description">${e.description}</p>\n                    </div>\n                    <button class="accordion-toggle" aria-expanded="false" aria-label="${t}">\n                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="accordion-icon"><path d="M12 15.0006L17.5228 9.47778L18.9371 10.892L12 17.8291L5.06291 10.892L6.47712 9.47778L12 15.0006Z"></path></svg>\n                    </button>\n                </div>\n                <div class="accordion-content">\n                    <div class="service-detail-list">\n                        ${o}\n                    </div>\n                </div>\n            </div>\n        `}function a(t){const o=e[t];o&&(i.style.setProperty("--current-service-color",n[t]),document.querySelectorAll(".service-selector-btn").forEach(e=>{e.classList.toggle("active",e.dataset.client===t)}),s.innerHTML=o.accordion.map(l).join(""),function(){const e=s.querySelectorAll(".accordion-item");e.forEach(t=>{const o=t.querySelector(".accordion-header"),s=t.querySelector(".accordion-toggle");o.addEventListener("click",()=>{const o=t.querySelector(".accordion-content"),i=t.classList.contains("active");e.forEach(e=>{e!==t&&(e.classList.remove("active"),e.querySelector(".accordion-content").style.maxHeight=null,e.querySelector(".accordion-toggle").setAttribute("aria-expanded","false"))}),i?(t.classList.remove("active"),o.style.maxHeight=null,s.setAttribute("aria-expanded","false")):(t.classList.add("active"),o.style.maxHeight=o.scrollHeight+"px",s.setAttribute("aria-expanded","true"),setTimeout(()=>{t.scrollIntoView({behavior:"smooth",block:"center"})},500))})})}())}o&&(o.addEventListener("click",e=>{if(e.target.matches(".service-selector-btn")){a(e.target.dataset.client)}}),a("artist"));const r=document.getElementById("heroVideo"),c=document.getElementById("sound-toggle"),d=document.getElementById("icon-mute"),u=document.getElementById("icon-unmute"),m=document.querySelector(".hero-overlay");if(r){new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?r.play().catch(e=>console.log("Video autoplay was prevented.")):r.pause()})},{threshold:.1}).observe(r)}c&&r&&d&&u&&m&&c.addEventListener("click",()=>{r.muted=!r.muted,d.classList.toggle("is-hidden",!r.muted),u.classList.toggle("is-hidden",r.muted),m.classList.toggle("sound-is-active",!r.muted),c.classList.toggle("is-blinking",r.muted),r.muted||(r.currentTime=0,r.play().catch(e=>console.log("Video play was prevented.")))});const p=document.getElementById("mobile-nav-toggle"),v=document.getElementById("mobile-nav"),g=document.getElementById("mobile-nav-icon-open"),f=document.getElementById("mobile-nav-icon-close");p&&v&&g&&f&&(p.addEventListener("click",()=>{const e=v.classList.toggle("is-open");g.classList.toggle("is-hidden",e),f.classList.toggle("is-hidden",!e)}),v.querySelectorAll("a").forEach(e=>{e.addEventListener("click",()=>{v.classList.remove("is-open"),g.classList.remove("is-hidden"),f.classList.add("is-hidden")})})),document.querySelectorAll(".map-dot").forEach(e=>{e.setAttribute("aria-pressed","false"),e.addEventListener("click",()=>{const t=e.dataset.region,o=document.getElementById(`panel-${t}`);e.classList.contains("active")?(e.classList.remove("active"),e.setAttribute("aria-pressed","false"),o&&(o.style.display="none")):(document.querySelectorAll(".map-dot").forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-pressed","false")}),document.querySelectorAll(".instrument-panel").forEach(e=>e.style.display="none"),e.classList.add("active"),e.setAttribute("aria-pressed","true"),o&&(o.style.display="block",o.scrollIntoView({behavior:"smooth",block:"center"})))})}),document.querySelectorAll(".close-panel-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".instrument-panel"),o=t.id.replace("panel-",""),s=document.getElementById(`dot-${o}`);t.style.display="none",s&&(s.classList.remove("active"),s.setAttribute("aria-pressed","false"));const i=document.querySelector(".percussion-map-container");i&&i.scrollIntoView({behavior:"smooth",block:"center"})})});const h=new IntersectionObserver((e,t)=>{e[0].isIntersecting&&(console.log("Portfolio section is visible, loading Swiper.js..."),import("https://cdn.jsdelivr.net/npm/swiper@11/swiper.mjs").then(({default:e})=>{import("https://cdn.jsdelivr.net/npm/swiper@11/modules/navigation.mjs").then(({default:t})=>{window.Swiper=e,window.SwiperNavigation=t,A(w),console.log("Swiper.js loaded and initialized successfully.")})}).catch(e=>console.error("Failed to load Swiper modules:",e)),t.unobserve(e[0].target))},{rootMargin:"200px"}),y=document.getElementById("portfolio");y&&h.observe(y);const w=Array.from(document.querySelectorAll("#portfolio-slider-data .portfolio-data-item")).map(e=>({isLoaded:!1,title:e.dataset.title,desc:e.dataset.desc,tags:e.dataset.tags,soundcloudUrl:e.dataset.soundcloudUrl,artistLinks:{spotify:e.dataset.spotify,instagram:e.dataset.instagram,youtube:e.dataset.youtube,facebook:e.dataset.facebook,website:e.dataset.website,linkedin:e.dataset.linkedin,appleMusic:e.dataset.appleMusic,soundcloud:e.dataset.soundcloud,deezer:e.dataset.deezer}})),L=document.getElementById("portfolio-slider");let b,E=!1,k=!1;function S(e){const t=function(e){if(!e)return null;const t=e.dataset.soundcloudUrl;return w.find(e=>e.soundcloudUrl===t)}(e);if(!t||t.isLoaded)return;const o=e.querySelector(".soundcloud-placeholder");if(!o)return;t.isLoaded=!0,e.classList.add("is-loaded");const s=o.dataset.src,i=o.dataset.title,n=document.createElement("div");n.className="soundcloud-classic-viewport";const l=document.createElement("iframe");l.title=`SoundCloud player for ${i}`,l.width="480",l.height="166",l.scrolling="no",l.frameBorder="no",l.allow="autoplay",l.src=s,n.appendChild(l),o.parentNode.replaceChild(n,o),I()}function B(){k||(k=!0,console.log("User interaction detected. Loading all remaining players with priority."),b&&b.slides[b.activeIndex]&&S(b.slides[b.activeIndex]),requestAnimationFrame(()=>{document.querySelectorAll("#portfolio-slider .swiper-slide:not(.is-loaded)").forEach(S)}))}function x(){if(E)return;if(E=!0,console.log("Portfolio in view. Performing initial smart load."),0===w.length)return;const e=e=>document.querySelector(`.swiper-slide[data-soundcloud-url="${e}"]`);window.innerWidth>768?(console.log("Desktop detected. Loading 3 players."),S(e(w[w.length-1].soundcloudUrl)),S(e(w[0].soundcloudUrl)),w.length>1&&S(e(w[1].soundcloudUrl))):(console.log("Mobile detected. Loading 1 player."),S(e(w[0].soundcloudUrl)))}function I(){const e=document.querySelector(".swiper-slide-active .soundcloud-classic-wrapper");if(!e||document.querySelector(".portfolio-slider-wrapper").classList.contains("is-hidden"))return;const t=e.offsetWidth/480;document.documentElement.style.setProperty("--soundcloud-scale",t)}function q(e){const t=e.tags.split(" ").map(e=>`<span class="tag">${e.replace(/-/g," ")}</span>`).join("");let o="";if(e.artistLinks){const t={spotify:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm4.333 14.933c-.2.333-.533.4-.866.2-2.333-1.4-5.266-1.733-8.8-1.066-.333.067-.6-.133-.667-.466-.067-.333.133-.6.467-.667 3.8-.733 7.066-.333 9.666 1.2.334.2.4.534.2.867zm1.067-2.333c-.267.333-.667.467-1.067.267-2.666-1.6-6.6-2.067-9.733-1.133-.4.133-.8-.133-.933-.533-.133-.4.133-.8.533-.933 3.533-1.067 7.933-.533 10.933 1.267.4.2.533.667.267 1.067zm1-2.467c-.267.4-.8.534-1.2.267-3.067-1.866-8.2-2.266-11.467-1.2-.466.133-.933-.2-.1-.666-.133-.467.2-.934.667-1.067 3.667-1.2 9.267-.733 12.733 1.333.4.267.533.8.267 1.2z"/></svg>',instagram:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.012 3.584-.07 4.85c-.148 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.584-.012-4.85-.07c-3.252-.148-4.771-1.691-4.919-4.919-.058-1.265-.069-1.645-.069-4.85s.012-3.584.07-4.85c.148-3.225 1.664-4.771 4.919-4.919C8.428 2.175 8.796 2.163 12 2.163zm0 1.444c-3.117 0-3.486.012-4.71.068-2.92.132-4.343 1.543-4.475 4.475-.056 1.225-.068 1.594-.068 4.71s.012 3.486.068 4.71c.132 2.932 1.555 4.343 4.475 4.475 1.225.056 1.594.068 4.71.068s3.486-.012 4.71-.068c2.92-.132 4.343-1.543 4.475-4.475.056-1.225.068-1.594.068-4.71s-.012-3.486-.068-4.71c-.132-2.932-1.555-4.343-4.475-4.475C15.486 3.619 15.117 3.607 12 3.607zm0 3.082a5.31 5.31 0 1 0 0 10.62 5.31 5.31 0 0 0 0-10.62zm0 8.778a3.468 3.468 0 1 1 0-6.936 3.468 3.468 0 0 1 0 6.936zm4.868-8.62a1.2 1.2 0 1 0 0 2.4 1.2 1.2 0 0 0 0-2.4z"/></svg>',youtube:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M20 4.47A2.47 2.47 0 0 0 17.53 2H6.47A2.47 2.47 0 0 0 4 4.47v15.06A2.47 2.47 0 0 0 6.47 22h11.06A2.47 2.47 0 0 0 20 19.53V4.47zM10 16.5v-9l6 4.5-6 4.5z"></path></svg>',facebook:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm2.5 10.5h-2v5h-3v-5h-2v-3h2v-2c0-1.7 1.1-4 4-4h2v3h-1.5c-.5 0-1 .5-1 1v2h2.5l-.5 3z"/></svg>',website:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M10 6V8H5V19H19V14H21V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V8C3 6.89543 3.89543 6 5 6H10ZM14 4V6H18.5858L11.2929 13.2929L12.7071 14.7071L20 7.41421V12H22V4H14Z"></path></svg>',linkedin:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM9 17H6v-7h3v7zm-1.5-8.25A1.75 1.75 0 1 1 7.5 7a1.75 1.75 0 0 1 0 1.75zm10.5 8.25h-3v-3.5c0-1-.5-2-1.5-2s-1.5 1-1.5 2v3.5h-3v-7h3v1.25c.5-.75 1.5-1.25 2.5-1.25 2 0 3.5 1.5 3.5 4v4.5z"/></svg>',appleMusic:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>',soundcloud:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/></svg>',deezer:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="artist-link-icon"><path d="M2 17h2v-5H2v5zm4 0h2V7H6v10zm4 0h2v-8h-2v8zm4 0h2V4h-2v13zm4 0h2v-6h-2v6z"/></svg>'},s={spotify:"Listen on Spotify",instagram:"Follow on Instagram",youtube:"Watch on YouTube",facebook:"Find on Facebook",website:"Visit Website",linkedin:"View on LinkedIn",appleMusic:"Listen on Apple Music",soundcloud:"Listen on SoundCloud",deezer:"Listen on Deezer"},i=Object.keys(e.artistLinks).map(o=>t[o]&&e.artistLinks[o]?`<a href="${e.artistLinks[o]}" target="_blank" rel="noopener noreferrer" title="${s[o]}" aria-label="${s[o]}">${t[o]}</a>`:"").join("");i&&(o=`<div class="artist-links">${i}</div>`)}const s=`https://w.soundcloud.com/player/?url=${encodeURIComponent(e.soundcloudUrl)}&color=%23EE8F00&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=false&visual=false`;let i;return i=e.isLoaded?`<div class="soundcloud-classic-wrapper">\n                <div class="soundcloud-classic-viewport">\n                    <iframe title="SoundCloud player for ${e.title}" width="480" height="166" scrolling="no" frameborder="no" allow="autoplay" src="${s}"></iframe>\n                </div>\n            </div>`:`<div class="soundcloud-classic-wrapper"><div class="soundcloud-placeholder" data-src="${s}" data-title="${e.title}"></div></div>`,`<div class="swiper-slide portfolio-item ${e.isLoaded?"is-loaded":""}" data-tags="${e.tags}" data-soundcloud-url="${e.soundcloudUrl}">${i}<div class="portfolio-info"><h3 class="portfolio-title">${e.title}</h3><p class="portfolio-desc">${e.desc}</p><div class="portfolio-tags">${t}</div>${o}</div></div>`}function A(e){if(b&&b.destroy(!0,!0),void 0===window.Swiper||void 0===window.SwiperNavigation){console.log("Swiper not loaded yet, skipping initialization.");const t=e.map(q).join("");return L.innerHTML=t,void x()}const t=e.map(q).join("");L.innerHTML=t,L&&L.children.length&&(b=new Swiper(".portfolio-swiper",{modules:[window.SwiperNavigation],loop:e.length>2,slidesPerView:"auto",centeredSlides:!0,spaceBetween:30,grabCursor:!0,navigation:{nextEl:".portfolio-next",prevEl:".portfolio-prev"},breakpoints:{320:{spaceBetween:15},768:{spaceBetween:20},1024:{spaceBetween:30}}}),b.on("navigationNext",B),b.on("navigationPrev",B),b.el.addEventListener("pointerdown",B,{once:!0}),b.on("transitionEnd",I),b.on("resize",I),I(),x())}function $(e="desktop"){const t="mobile"===e?document.querySelector(".filter-panel-body"):document.querySelector(".portfolio-filters"),o=Array.from(t.querySelectorAll('.filter-btn[data-group="app"].active:not([data-filter="all"])')).map(e=>e.dataset.filter),s=Array.from(t.querySelectorAll('.filter-btn[data-group="style"].active:not([data-filter="all"])')).map(e=>e.dataset.filter.split(",")).flat(),i=w.filter(e=>{const t=e.tags.split(" "),i=0===o.length||o.some(e=>t.includes(e)),n=0===s.length||s.some(e=>t.includes(e));return i&&n}),n=document.getElementById("no-results-container"),l=document.querySelector(".portfolio-slider-wrapper");i.length>0?(l.classList.remove("is-hidden"),n.classList.add("is-hidden"),A(i)):(b&&b.destroy(!0,!0),b=null,l.classList.add("is-hidden"),n.classList.remove("is-hidden"),n.innerHTML='<h3>No Matches Found</h3><p>Try adjusting your filters or reset them to see all projects.</p><button class="reset-filters-btn">Reset Filters</button>',n.querySelector(".reset-filters-btn").addEventListener("click",()=>V(e))),"mobile"===e&&function(){const e=Array.from(document.querySelectorAll('.filter-panel-body .filter-btn.active:not([data-filter="all"])')),t=e.length,o=document.getElementById("active-filters-pills");o.innerHTML="",t>0?(document.getElementById("active-filters-container").classList.remove("is-hidden"),document.getElementById("mobile-filter-trigger-text").textContent=`Filter Projects (${t})`,e.forEach(e=>{const t=document.createElement("div");t.className="filter-pill",t.textContent=e.textContent;const s=document.createElement("button");s.className="remove-pill-btn",s.innerHTML="&times;",s.onclick=()=>{e.classList.remove("active"),document.querySelector(`.filter-panel-body .filter-btn[data-group="${e.dataset.group}"].active:not([data-filter="all"])`)||document.querySelector(`.filter-panel-body .filter-btn[data-group="${e.dataset.group}"][data-filter="all"]`).classList.add("active"),$("mobile")},t.appendChild(s),o.appendChild(t)})):(document.getElementById("active-filters-container").classList.add("is-hidden"),document.getElementById("mobile-filter-trigger-text").textContent="Filter Projects")}(),H()}const C=document.querySelector(".portfolio-filters"),z=document.querySelector(".filter-panel-body"),M=document.getElementById("portfolio");if(C&&z&&M){z.innerHTML=C.innerHTML;const e=document.getElementById("mobile-filter-trigger"),t=document.getElementById("filter-panel-overlay"),o=document.getElementById("filter-panel-close-btn"),s=document.getElementById("apply-filters-btn"),i=document.getElementById("clear-filters-btn"),n=document.getElementById("desktop-clear-filters-btn"),l=document.getElementById("portfolio-filters-container");e.addEventListener("click",()=>{B(),window.innerWidth>768?l.classList.remove("filters-hidden"):t.classList.add("is-open")}),o.addEventListener("click",()=>t.classList.remove("is-open")),t.addEventListener("click",e=>{e.target===t&&t.classList.remove("is-open")}),s.addEventListener("click",()=>{$("mobile"),t.classList.remove("is-open")}),i.addEventListener("click",()=>V("mobile")),document.getElementById("clear-all-pills-btn").addEventListener("click",()=>V("mobile")),n.addEventListener("click",()=>V("desktop")),j(C,"desktop"),j(z,"mobile");new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(x(),t.unobserve(M))})},{rootMargin:"0px 0px 100px 0px"}).observe(M),H()}function H(){const e=document.querySelector('.portfolio-filters .filter-btn.active:not([data-filter="all"])');document.getElementById("desktop-clear-filters-container").classList.toggle("is-hidden",!e)}function V(e){const t="desktop"===e?document.querySelector(".portfolio-filters"):document.querySelector(".filter-panel-body");t.querySelectorAll(".filter-btn").forEach(e=>e.classList.remove("active")),t.querySelectorAll('.filter-btn[data-filter="all"]').forEach(e=>e.classList.add("active")),$(e)}function j(e,t){e.addEventListener("click",o=>{if(!o.target.matches(".filter-btn"))return;const s=o.target,i=s.dataset.group;"all"===s.dataset.filter?(e.querySelectorAll(`.filter-btn[data-group="${i}"]`).forEach(e=>e.classList.remove("active")),s.classList.add("active")):(e.querySelector(`.filter-btn[data-group="${i}"][data-filter="all"]`).classList.remove("active"),s.classList.toggle("active"),e.querySelector(`.filter-btn[data-group="${i}"].active:not([data-filter="all"])`)||e.querySelector(`.filter-btn[data-group="${i}"][data-filter="all"]`).classList.add("active")),"desktop"===t&&$("desktop")})}document.querySelectorAll(".slider-btn").forEach(e=>{const t=()=>e.classList.remove("btn-active-touch");e.addEventListener("touchstart",()=>e.classList.add("btn-active-touch"),{passive:!0}),e.addEventListener("touchend",t),e.addEventListener("touchcancel",t)});const F=document.getElementById("instrument-modal"),T=document.getElementById("instrument-modal-img"),U=document.getElementById("instrument-modal-name"),P=document.getElementById("instrument-modal-desc"),N=document.getElementById("instrument-sound-btn"),_=document.getElementById("instrument-modal-close");let W=null;if(F){T.addEventListener("load",()=>{T.style.visibility="visible"}),document.querySelectorAll(".instrument-list").forEach(e=>{e.addEventListener("click",e=>{if(e.target.matches(".instrument-list-item")){const t=e.target;T.style.visibility="hidden",U.textContent=t.dataset.name,P.textContent=t.dataset.description,T.src=`assets/img/instruments/${t.dataset.instrument}.webp`,T.alt=t.dataset.name,T.onerror=()=>{T.src=`https://placehold.co/200x200/073B38/FFFFFF?text=${t.dataset.name.replace(/ /g,"+")}`,T.style.visibility="visible"},N.dataset.audioSrc=`assets/audio/${t.dataset.instrument}.mp3`,F.classList.add("is-visible")}})});const e=e=>{W&&W.pause(),W=new Audio(e),W.play().catch(console.error)};N.addEventListener("click",()=>{N.dataset.audioSrc&&e(N.dataset.audioSrc)});const t=()=>{W&&W.pause(),F.classList.remove("is-visible")};_.addEventListener("click",t),F.addEventListener("click",e=>{e.target===F&&t()})}const O=document.getElementById("contact-phone-link"),D=document.getElementById("contact-apps-modal");if(O&&D){const e=document.getElementById("contact-apps-close");O.addEventListener("click",e=>{window.innerWidth<=768&&(e.preventDefault(),D.classList.add("is-visible"))});const t=()=>D.classList.remove("is-visible");e.addEventListener("click",t),D.addEventListener("click",e=>{e.target===D&&t()})}});