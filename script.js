document.addEventListener("DOMContentLoaded",function(){const e={},t=document.getElementById("services-data");t&&t.querySelectorAll("[data-client-profile]").forEach(t=>{const o=t.dataset.clientProfile;e[o]={accordion:Array.from(t.querySelectorAll(".service-item")).map(e=>({title:e.dataset.title,description:e.dataset.description,details:Array.from(e.querySelectorAll(".service-detail")).map(e=>({title:e.dataset.title,text:e.dataset.text}))}))}});const o=document.getElementById("service-selector"),i=document.getElementById("services-accordion"),s=document.documentElement,n={artist:"var(--color-artist)",producer:"var(--color-producer)",media:"var(--color-media)",enterprise:"var(--color-enterprise)"};function l(e){const t="es"===document.documentElement.lang?`Expandir detalles de ${e.title}`:`Expand details for ${e.title}`,o=e.details.map(e=>`\n            <div class="service-detail-item">\n                <h4>${e.title}</h4>\n                <p>${e.text}</p>\n            </div>\n        `).join("");return`\n            <div class="accordion-item">\n                <div class="accordion-header">\n                    <div class="accordion-text">\n                        <h3 class="accordion-title">${e.title}</h3>\n                        <p class="accordion-description">${e.description}</p>\n                    </div>\n                    <button class="accordion-toggle" aria-expanded="false" aria-label="${t}">\n                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor"><path d="M12 15.0006L17.5228 9.47778L18.9371 10.892L12 17.8291L5.06291 10.892L6.47712 9.47778L12 15.0006Z"></path></svg>\n                    </button>\n                </div>\n                <div class="accordion-content">\n                    <div class="service-detail-list">\n                        ${o}\n                    </div>\n                </div>\n            </div>\n        `}function r(t){const o=e[t];o&&(s.style.setProperty("--current-service-color",n[t]),document.querySelectorAll(".service-selector-btn").forEach(e=>{e.classList.toggle("active",e.dataset.client===t)}),i.innerHTML=o.accordion.map(l).join(""),function(){const e=i.querySelectorAll(".accordion-item");e.forEach(t=>{const o=t.querySelector(".accordion-header"),i=t.querySelector(".accordion-toggle");o.addEventListener("click",()=>{const o=t.querySelector(".accordion-content"),s=t.classList.contains("active");e.forEach(e=>{e!==t&&(e.classList.remove("active"),e.querySelector(".accordion-content").style.maxHeight=null,e.querySelector(".accordion-toggle").setAttribute("aria-expanded","false"))}),s?(t.classList.remove("active"),o.style.maxHeight=null,i.setAttribute("aria-expanded","false")):(t.classList.add("active"),o.style.maxHeight=o.scrollHeight+"px",i.setAttribute("aria-expanded","true"),setTimeout(()=>{t.scrollIntoView({behavior:"smooth",block:"center"})},500))})})}())}o&&(o.addEventListener("click",e=>{if(e.target.matches(".service-selector-btn")){r(e.target.dataset.client)}}),r("artist"));const a=document.getElementById("heroVideo"),c=document.getElementById("sound-toggle"),d=document.getElementById("icon-mute"),u=document.getElementById("icon-unmute"),m=document.querySelector(".hero-overlay");if(a){new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?a.play().catch(e=>console.log("Video autoplay was prevented.")):a.pause()})},{threshold:.1}).observe(a)}c&&a&&d&&u&&m&&c.addEventListener("click",()=>{a.muted=!a.muted,d.classList.toggle("is-hidden",!a.muted),u.classList.toggle("is-hidden",a.muted),m.classList.toggle("sound-is-active",!a.muted),c.classList.toggle("is-blinking",a.muted),a.muted||(a.currentTime=0,a.play().catch(e=>console.log("Video play was prevented.")))});const p=document.getElementById("mobile-nav-toggle"),v=document.getElementById("mobile-nav"),g=document.getElementById("mobile-nav-icon-open"),f=document.getElementById("mobile-nav-icon-close");p&&v&&g&&f&&(p.addEventListener("click",()=>{const e=v.classList.toggle("is-open");g.classList.toggle("is-hidden",e),f.classList.toggle("is-hidden",!e)}),v.querySelectorAll("a").forEach(e=>{e.addEventListener("click",()=>{v.classList.remove("is-open"),g.classList.remove("is-hidden"),f.classList.add("is-hidden")})})),document.querySelectorAll(".map-dot").forEach(e=>{e.setAttribute("aria-pressed","false"),e.addEventListener("click",()=>{const t=e.dataset.region,o=document.getElementById(`panel-${t}`);e.classList.contains("active")?(e.classList.remove("active"),e.setAttribute("aria-pressed","false"),o&&(o.style.display="none")):(document.querySelectorAll(".map-dot").forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-pressed","false")}),document.querySelectorAll(".instrument-panel").forEach(e=>e.style.display="none"),e.classList.add("active"),e.setAttribute("aria-pressed","true"),o&&(o.style.display="block",o.scrollIntoView({behavior:"smooth",block:"center"})))})}),document.querySelectorAll(".close-panel-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".instrument-panel"),o=t.id.replace("panel-",""),i=document.getElementById(`dot-${o}`);t.style.display="none",i&&(i.classList.remove("active"),i.setAttribute("aria-pressed","false"));const s=document.querySelector(".percussion-map-container");s&&s.scrollIntoView({behavior:"smooth",block:"center"})})});const h=new IntersectionObserver((e,t)=>{e[0].isIntersecting&&(console.log("Portfolio section is visible, loading Swiper.js..."),import("https://cdn.jsdelivr.net/npm/swiper@11/swiper.mjs").then(({default:e})=>{import("https://cdn.jsdelivr.net/npm/swiper@11/modules/navigation.mjs").then(({default:t})=>{window.Swiper=e,window.SwiperNavigation=t,$(w),console.log("Swiper.js loaded and initialized successfully.")})}).catch(e=>console.error("Failed to load Swiper modules:",e)),t.unobserve(e[0].target))},{rootMargin:"200px"}),y=document.getElementById("portfolio");y&&h.observe(y);const w=Array.from(document.querySelectorAll("#portfolio-slider-data .portfolio-data-item")).map(e=>({isLoaded:!1,title:e.dataset.title,desc:e.dataset.desc,tags:e.dataset.tags,soundcloudUrl:e.dataset.soundcloudUrl,artistLinks:{spotify:e.dataset.spotify,instagram:e.dataset.instagram,youtube:e.dataset.youtube,facebook:e.dataset.facebook,website:e.dataset.website,linkedin:e.dataset.linkedin}})),b=document.getElementById("portfolio-slider");let L,E=!1,S=!1;function k(e){const t=function(e){if(!e)return null;const t=e.dataset.soundcloudUrl;return w.find(e=>e.soundcloudUrl===t)}(e);if(!t||t.isLoaded)return;const o=e.querySelector(".soundcloud-placeholder");if(!o)return;t.isLoaded=!0,e.classList.add("is-loaded");const i=o.dataset.src,s=o.dataset.title,n=document.createElement("div");n.className="soundcloud-classic-viewport";const l=document.createElement("iframe");l.title=`SoundCloud player for ${s}`,l.width="480",l.height="166",l.scrolling="no",l.frameBorder="no",l.allow="autoplay",l.src=i,n.appendChild(l),o.parentNode.replaceChild(n,o),x()}function I(){S||(S=!0,console.log("User interaction detected. Loading all remaining players with priority."),L&&L.slides[L.activeIndex]&&k(L.slides[L.activeIndex]),requestAnimationFrame(()=>{document.querySelectorAll("#portfolio-slider .swiper-slide:not(.is-loaded)").forEach(k)}))}function B(){if(E)return;if(E=!0,console.log("Portfolio in view. Performing initial smart load."),0===w.length)return;const e=e=>document.querySelector(`.swiper-slide[data-soundcloud-url="${e}"]`);window.innerWidth>768?(console.log("Desktop detected. Loading 3 players."),k(e(w[w.length-1].soundcloudUrl)),k(e(w[0].soundcloudUrl)),w.length>1&&k(e(w[1].soundcloudUrl))):(console.log("Mobile detected. Loading 1 player."),k(e(w[0].soundcloudUrl)))}function x(){const e=document.querySelector(".swiper-slide-active .soundcloud-classic-wrapper");if(!e||document.querySelector(".portfolio-slider-wrapper").classList.contains("is-hidden"))return;const t=e.offsetWidth/480;document.documentElement.style.setProperty("--soundcloud-scale",t)}function q(e){const t=e.tags.split(" ").map(e=>`<span class="tag">${e.replace(/-/g," ")}</span>`).join("");let o="";if(e.artistLinks){const t={spotify:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm4.333 14.933c-.2.333-.533.4-.866.2-2.333-1.4-5.266-1.733-8.8-1.066-.333.067-.6-.133-.667-.466-.067-.333.133-.6.467-.667 3.8-.733 7.066-.333 9.666 1.2.334.2.4.534.2.867zm1.067-2.333c-.267.333-.667.467-1.067.267-2.666-1.6-6.6-2.067-9.733-1.133-.4.133-.8-.133-.933-.533-.133-.4.133-.8.533-.933 3.533-1.067 7.933-.533 10.933 1.267.4.2.533.667.267 1.067zm1-2.467c-.267.4-.8.534-1.2.267-3.067-1.866-8.2-2.266-11.467-1.2-.466.133-.933-.2-.1-.666-.133-.467.2-.934.667-1.067 3.667-1.2 9.267-.733 12.733 1.333.4.267.533.8.267 1.2z"/></svg>',instagram:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2c2.717 0 3.056.01 4.122.06 1.065.05 1.79.217 2.428.465.66.254 1.216.598 1.772 1.153a4.908 4.908 0 0 1 1.153 1.772c.247.637.415 1.363.465 2.428.05 1.066.06 1.405.06 4.122s-.01 3.056-.06 4.122c-.05 1.065-.218 1.79-.465 2.428a4.883 4.883 0 0 1-1.153 1.772 4.915 4.915 0 0 1-1.772 1.153c-.637.247-1.363.415-2.428.465-1.066.05-1.405.06-4.122.06s-3.056-.01-4.122-.06c-1.065-.05-1.79-.218-2.428-.465a4.89 4.89 0 0 1-1.772-1.153 4.904 4.904 0 0 1-1.153-1.772c-.248-.637-.415-1.363-.465-2.428C2.01 15.056 2 14.717 2 12s.01-3.056.06-4.122c.05-1.066.217-1.79.465-2.428a4.88 4.88 0 0 1 1.153-1.772A4.897 4.897 0 0 1 5.45 2.525c.638-.248 1.362-.415 2.428-.465C8.944 2.01 9.283 2 12 2zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0 6a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6-10a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>',youtube:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm6.2 8.7c.2.5.2 1.6 0 2.1-.2.5-1 1-1 1s-2.8.3-5.2.3-5.2-.3-5.2-.3-.8-.4-1-1c-.2-.5-.2-1.6 0-2.1.2-.5 1-1 1-1s2.8-.3 5.2-.3 5.2.3 5.2.3.8.5 1 1zm-8.2 2.6l4-2.1-4-2.1v4.2z"/></svg>',facebook:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm2.5 10.5h-2v5h-3v-5h-2v-3h2v-2c0-1.7 1.1-4 4-4h2v3h-1.5c-.5 0-1 .5-1 1v2h2.5l-.5 3z"/></svg>',website:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-8h10v2H7v-2zm-2-2h14v2H5v-2z"/></svg>',linkedin:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM9 17H6v-7h3v7zm-1.5-8.25A1.75 1.75 0 1 1 7.5 7a1.75 1.75 0 0 1 0 1.75zm10.5 8.25h-3v-3.5c0-1-.5-2-1.5-2s-1.5 1-1.5 2v3.5h-3v-7h3v1.25c.5-.75 1.5-1.25 2.5-1.25 2 0 3.5 1.5 3.5 4v4.5z"/></svg>'},i={spotify:"Listen on Spotify",instagram:"Follow on Instagram",youtube:"Watch on YouTube",facebook:"Find on Facebook",website:"Visit Website",linkedin:"View on LinkedIn"},s=Object.keys(e.artistLinks).map(o=>t[o]&&e.artistLinks[o]?`<a href="${e.artistLinks[o]}" target="_blank" rel="noopener noreferrer" title="${i[o]}" aria-label="${i[o]}">${t[o]}</a>`:"").join("");s&&(o=`<div class="artist-links">${s}</div>`)}const i=`https://w.soundcloud.com/player/?url=${encodeURIComponent(e.soundcloudUrl)}&color=%23EE8F00&auto_play=false&hide_related=true&show_comments=false&show_user=true&show_reposts=false&show_teaser=false&visual=false`;let s;return s=e.isLoaded?`<div class="soundcloud-classic-wrapper">\n                <div class="soundcloud-classic-viewport">\n                    <iframe title="SoundCloud player for ${e.title}" width="480" height="166" scrolling="no" frameborder="no" allow="autoplay" src="${i}"></iframe>\n                </div>\n            </div>`:`<div class="soundcloud-classic-wrapper"><div class="soundcloud-placeholder" data-src="${i}" data-title="${e.title}"></div></div>`,`<div class="swiper-slide portfolio-item ${e.isLoaded?"is-loaded":""}" data-tags="${e.tags}" data-soundcloud-url="${e.soundcloudUrl}">${s}<div class="portfolio-info"><h3 class="portfolio-title">${e.title}</h3><p class="portfolio-desc">${e.desc}</p><div class="portfolio-tags">${t}</div>${o}</div></div>`}function $(e){if(L&&L.destroy(!0,!0),void 0===window.Swiper||void 0===window.SwiperNavigation){console.log("Swiper not loaded yet, skipping initialization.");const t=e.map(q).join("");return b.innerHTML=t,void B()}const t=e.map(q).join("");b.innerHTML=t,b&&b.children.length&&(L=new Swiper(".portfolio-swiper",{modules:[window.SwiperNavigation],loop:e.length>2,slidesPerView:"auto",centeredSlides:!0,spaceBetween:30,grabCursor:!0,navigation:{nextEl:".portfolio-next",prevEl:".portfolio-prev"},breakpoints:{320:{spaceBetween:15},768:{spaceBetween:20},1024:{spaceBetween:30}}}),L.on("navigationNext",I),L.on("navigationPrev",I),L.el.addEventListener("pointerdown",I,{once:!0}),L.on("transitionEnd",x),L.on("resize",x),x(),B())}function A(e="desktop"){const t="mobile"===e?document.querySelector(".filter-panel-body"):document.querySelector(".portfolio-filters"),o=Array.from(t.querySelectorAll('.filter-btn[data-group="app"].active:not([data-filter="all"])')).map(e=>e.dataset.filter),i=Array.from(t.querySelectorAll('.filter-btn[data-group="style"].active:not([data-filter="all"])')).map(e=>e.dataset.filter.split(",")).flat(),s=w.filter(e=>{const t=e.tags.split(" "),s=0===o.length||o.some(e=>t.includes(e)),n=0===i.length||i.some(e=>t.includes(e));return s&&n}),n=document.getElementById("no-results-container"),l=document.querySelector(".portfolio-slider-wrapper");s.length>0?(l.classList.remove("is-hidden"),n.classList.add("is-hidden"),$(s)):(L&&L.destroy(!0,!0),L=null,l.classList.add("is-hidden"),n.classList.remove("is-hidden"),n.innerHTML='<h3>No Matches Found</h3><p>Try adjusting your filters or reset them to see all projects.</p><button class="reset-filters-btn">Reset Filters</button>',n.querySelector(".reset-filters-btn").addEventListener("click",()=>F(e))),"mobile"===e&&function(){const e=Array.from(document.querySelectorAll('.filter-panel-body .filter-btn.active:not([data-filter="all"])')),t=e.length,o=document.getElementById("active-filters-pills");o.innerHTML="",t>0?(document.getElementById("active-filters-container").classList.remove("is-hidden"),document.getElementById("mobile-filter-trigger-text").textContent=`Filter Projects (${t})`,e.forEach(e=>{const t=document.createElement("div");t.className="filter-pill",t.textContent=e.textContent;const i=document.createElement("button");i.className="remove-pill-btn",i.innerHTML="&times;",i.onclick=()=>{e.classList.remove("active"),document.querySelector(`.filter-panel-body .filter-btn[data-group="${e.dataset.group}"].active:not([data-filter="all"])`)||document.querySelector(`.filter-panel-body .filter-btn[data-group="${e.dataset.group}"][data-filter="all"]`).classList.add("active"),A("mobile")},t.appendChild(i),o.appendChild(t)})):(document.getElementById("active-filters-container").classList.add("is-hidden"),document.getElementById("mobile-filter-trigger-text").textContent="Filter Projects")}(),j()}const C=document.querySelector(".portfolio-filters"),z=document.querySelector(".filter-panel-body"),M=document.getElementById("portfolio");if(C&&z&&M){z.innerHTML=C.innerHTML;const e=document.getElementById("mobile-filter-trigger"),t=document.getElementById("filter-panel-overlay"),o=document.getElementById("filter-panel-close-btn"),i=document.getElementById("apply-filters-btn"),s=document.getElementById("clear-filters-btn"),n=document.getElementById("desktop-clear-filters-btn"),l=document.getElementById("portfolio-filters-container");e.addEventListener("click",()=>{I(),window.innerWidth>768?l.classList.remove("filters-hidden"):t.classList.add("is-open")}),o.addEventListener("click",()=>t.classList.remove("is-open")),t.addEventListener("click",e=>{e.target===t&&t.classList.remove("is-open")}),i.addEventListener("click",()=>{A("mobile"),t.classList.remove("is-open")}),s.addEventListener("click",()=>F("mobile")),document.getElementById("clear-all-pills-btn").addEventListener("click",()=>F("mobile")),n.addEventListener("click",()=>F("desktop")),H(C,"desktop"),H(z,"mobile");new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(B(),t.unobserve(M))})},{rootMargin:"0px 0px 100px 0px"}).observe(M),j()}function j(){const e=document.querySelector('.portfolio-filters .filter-btn.active:not([data-filter="all"])');document.getElementById("desktop-clear-filters-container").classList.toggle("is-hidden",!e)}function F(e){const t="desktop"===e?document.querySelector(".portfolio-filters"):document.querySelector(".filter-panel-body");t.querySelectorAll(".filter-btn").forEach(e=>e.classList.remove("active")),t.querySelectorAll('.filter-btn[data-filter="all"]').forEach(e=>e.classList.add("active")),A(e)}function H(e,t){e.addEventListener("click",o=>{if(!o.target.matches(".filter-btn"))return;const i=o.target,s=i.dataset.group;"all"===i.dataset.filter?(e.querySelectorAll(`.filter-btn[data-group="${s}"]`).forEach(e=>e.classList.remove("active")),i.classList.add("active")):(e.querySelector(`.filter-btn[data-group="${s}"][data-filter="all"]`).classList.remove("active"),i.classList.toggle("active"),e.querySelector(`.filter-btn[data-group="${s}"].active:not([data-filter="all"])`)||e.querySelector(`.filter-btn[data-group="${s}"][data-filter="all"]`).classList.add("active")),"desktop"===t&&A("desktop")})}document.querySelectorAll(".slider-btn").forEach(e=>{const t=()=>e.classList.remove("btn-active-touch");e.addEventListener("touchstart",()=>e.classList.add("btn-active-touch"),{passive:!0}),e.addEventListener("touchend",t),e.addEventListener("touchcancel",t)});const T=document.getElementById("instrument-modal"),U=document.getElementById("instrument-modal-img"),P=document.getElementById("instrument-modal-name"),N=document.getElementById("instrument-modal-desc"),V=document.getElementById("instrument-sound-btn"),_=document.getElementById("instrument-modal-close");let W=null;if(T){U.addEventListener("load",()=>{U.style.visibility="visible"}),document.querySelectorAll(".instrument-list").forEach(e=>{e.addEventListener("click",e=>{if(e.target.matches(".instrument-list-item")){const t=e.target;U.style.visibility="hidden",P.textContent=t.dataset.name,N.textContent=t.dataset.description,U.src=`assets/img/instruments/${t.dataset.instrument}.webp`,U.alt=t.dataset.name,U.onerror=()=>{U.src=`https://placehold.co/200x200/073B38/FFFFFF?text=${t.dataset.name.replace(/ /g,"+")}`,U.style.visibility="visible"},V.dataset.audioSrc=`assets/audio/${t.dataset.instrument}.mp3`,T.classList.add("is-visible")}})});const e=e=>{W&&W.pause(),W=new Audio(e),W.play().catch(console.error)};V.addEventListener("click",()=>{V.dataset.audioSrc&&e(V.dataset.audioSrc)});const t=()=>{W&&W.pause(),T.classList.remove("is-visible")};_.addEventListener("click",t),T.addEventListener("click",e=>{e.target===T&&t()})}const O=document.getElementById("contact-phone-link"),D=document.getElementById("contact-apps-modal");if(O&&D){const e=document.getElementById("contact-apps-close");O.addEventListener("click",e=>{window.innerWidth<=768&&(e.preventDefault(),D.classList.add("is-visible"))});const t=()=>D.classList.remove("is-visible");e.addEventListener("click",t),D.addEventListener("click",e=>{e.target===D&&t()})}});